import { useEffect, useRef } from "react";
import { AnimatedLogoProps } from "./types";

import style from "components/common/AnimatedLogo/animatedLogo.module.css";

export default function AnimatedLogo({
  color = "#000",
  width = "100",
  animationTime = 1.5,
  className,
}: AnimatedLogoProps) {
  // TODO: Add infinit animation
  // could be use for loading animation ?
  // could it wrap a <Logo/> component that doesn't have an animation ?
  const group = useRef<any>(0);

  useEffect(() => {
    if (group.current) {
      const nodes: any = [...group.current.childNodes];

      const totalLength = nodes.reduce(
        (a: any, c: any) => c.getTotalLength() + a,
        0
      );
      const avrSpeed = totalLength / animationTime;
      let timeDelay = 0;

      nodes.map((node: any) => {
        const nodeLength = node.getTotalLength();
        const nodeTime = (nodeLength * animationTime) / avrSpeed;

        node.style.strokeDasharray = node.style.strokeDashoffset = nodeLength;

        node.style.animation = `${style.strokeOffset} ${nodeTime}s linear forwards ${timeDelay}s`;
        timeDelay = timeDelay + nodeTime;
      });
    }
  }, []);
  return (
    <div className={`${className}`} style={{ width: width }}>
      <svg
        className={style.svgContainer}
        viewBox={`0 0 255 210`}
        // preserveAspectRatio="xMidYMax meet"
        fill="none"
        xmlns="http://www.w3.org/2000/svg"
      >
        <defs>
          <clipPath id="clip_y">
            <path d="M94.3633 165.43C102.914 151.085 111.047 126.636 117.72 82.9937L119.5 71.5C121.996 49.275 123.56 32.8855 119.598 32.0773C106.877 32.0773 109.588 62.2288 94.5289 74.3274C64.1255 98.7536 60.9974 71.881 66.0024 57.9396C67.6708 50.4637 69.1306 49.5209 71.0075 40.5633C74.4162 24.0504 72.6758 11.4157 54.1154 7.62939C42.2285 5.20447 29.5073 10.1452 22.4168 16.3172C1.06194 34.9058 14.4921 37.6671 23.8766 36.7242C31.8013 36.7242 37.2234 13.8926 54.1154 19.3479C60.5802 20.5602 64.6926 26.8239 62.0401 40.5633C56.6179 68.6482 46.1907 74.3274 50.5702 87.4388C64.9597 109.249 88.0431 90.7531 94.5289 86.0463C105.417 78.1445 109.588 68.042 110.17 74.3274V77.1341L107.92 89.2573C99.0913 124.481 87.2739 193.755 42.437 176.745L29.0056 191C43.3858 204.038 72.7356 199.269 94.3633 165.43Z" />
          </clipPath>
          <clipPath id="clip_r">
            <path d="M220.957 173.512C196.349 212.305 162.557 180.179 146.29 120.17C169.813 112.329 191.093 101.001 204.474 91.6817C261.089 52.2528 232.709 9.06973 203.022 17.7312C174.064 26.1799 137.174 57.6641 119 71.5L109 77.991C40.1486 128.477 22.1989 148.352 20.5399 165.43C19.514 175.99 22.4964 184.437 28 190.034L29.5 191.5C34.7453 185.933 43 177 43 177L41.5 176.154C13.3728 157.516 74.1644 110.536 107 89.8347L118.544 82.2059C125.5 76.5 146.945 61.6862 171.316 49.0493C195.715 36.3974 216.426 29.9818 220.957 35.5116C227.622 43.9981 204.474 73.8392 184.037 84.8117C151.295 102.39 121.669 103.602 122.941 107.441C164.859 233.924 220.957 203.819 236.181 178.563C248.359 158.358 246.386 150.092 239.511 147.649C235.542 146.239 231.586 145.831 227.624 150.276C222.827 158.156 226.724 164.419 220.957 173.512Z" />
          </clipPath>
        </defs>
        <g ref={group}>
          <path
            id="stroke_y"
            clipPath="url(#clip_y)"
            d="M11.8297 38.6785C15.1124 36.2429 19.0326 32.5964 20.7721 28.6597C21.5302 26.944 23.1163 25.4307 24.7465 24.5197C26.9046 23.3137 28.6877 21.8712 31.0117 20.9317C33.9617 19.7392 36.4298 17.8951 38.9604 16.0189C40.4839 14.8894 42.032 13.166 44.0664 13.0933C46.5227 13.0056 48.931 12.3481 51.4356 12.3481C53.8147 12.3481 55.9947 12.1414 58.0872 13.3969C59.179 14.052 59.957 15.112 61.0128 15.7153C61.6194 16.062 62.3336 16.7336 62.5032 17.4541C62.6402 18.0366 63.1158 18.5137 63.3864 19.0549C63.7359 19.754 63.8875 20.4927 64.242 21.1663C64.797 22.2209 65.3695 23.983 65.4702 25.1407C65.5854 26.4657 65.9808 27.5251 65.9808 28.9219C65.9808 29.6192 66.1341 30.0931 66.2154 30.7435C66.4285 32.4485 66.2292 34.3064 66.2292 36.0289C66.2292 37.95 66.7766 39.6857 66.726 41.6593C66.6622 44.147 65.7584 47.0005 64.9872 49.3597C64.7002 50.2376 64.6359 51.0868 64.3524 51.9541C64.049 52.8821 63.711 53.7218 63.4416 54.6312C62.3773 58.2231 61.2303 61.8559 59.8122 65.3124C59.047 67.1776 59.0218 69.4601 58.1424 71.2188C57.2487 73.0061 57.0937 74.9305 56.79 76.9044C56.4556 79.0779 56.8785 81.1227 58.032 83.0178C59.0597 84.7062 59.4231 86.6603 60.4056 88.3446C60.7174 88.8791 62.0851 88.8552 62.6136 88.8552C63.8325 88.8552 64.9869 89.251 66.1878 89.4762C67.4417 89.7113 68.5726 90.1543 69.831 90.3732C70.3286 90.4597 70.6548 90.8233 71.1696 90.8424C72.0042 90.8733 72.8459 90.8424 73.6812 90.8424C75.3326 90.8424 76.984 90.8424 78.6354 90.8424C79.664 90.8424 80.4969 89.969 81.3678 89.49C82.2761 88.9904 83.0647 88.7878 83.8932 88.11C84.6743 87.4708 85.8753 87.2767 86.4875 86.4264C87.9505 84.3944 90.2109 82.407 92.0627 80.658C93.7887 79.0279 95.4815 77.3803 96.8927 75.5658C97.7446 74.4706 98.1064 72.6966 98.8937 71.4534C99.8575 69.9316 100.262 68.2317 100.881 66.6234C101.523 64.9531 101.75 63.0754 101.75 61.269C101.75 59.4824 102.109 58.131 102.689 56.508C103.276 54.8646 104.308 53.2222 104.786 51.5953C105.278 49.9228 106.596 48.0379 106.718 46.3237C106.812 45.0155 107.96 44.1071 107.96 42.7909C107.96 41.9018 107.922 41.0023 107.96 40.1137C108.065 37.707 109.074 35.2983 109.202 32.8549C109.316 30.703 110.905 25.9077 113.867 26.9209C115.867 27.6051 116.459 30.1379 117.261 31.8337C118.507 34.4666 119.387 36.8531 119.387 39.7549C119.387 42.1975 119.563 44.6671 119.083 47.0689C118.825 48.3577 118.341 49.6943 117.841 50.9053C117.263 52.3054 116.239 53.5875 115.909 55.0728C115.585 56.5332 114.17 57.6328 114.17 59.1852C114.17 60.7538 114.17 62.3224 114.17 63.891C114.17 65.865 113.673 67.8026 113.673 69.7422C113.673 71.9213 113.445 74.192 112.983 76.3248C112.586 78.1643 112.664 80.1475 112.238 82.0104C112.016 82.9839 112.138 83.8438 111.797 84.8256C111.459 85.7972 111.373 87.3351 111.245 88.3584C111.066 89.7874 111.184 91.2746 110.886 92.6916C110.739 93.3882 110.723 94.1161 110.541 94.803C110.402 95.3289 109.984 95.8179 109.947 96.3624C109.709 99.9401 108.244 103.355 107.091 106.726C106.29 109.069 106.222 111.046 106.222 113.599C106.222 114.715 106.532 116.388 105.973 117.394C104.712 119.664 104.811 122.641 103.848 125.08C101.79 130.293 99.0544 135.514 96.7547 140.771C94.2584 146.477 92.8979 152.514 90.0755 158.159C89.1741 159.961 87.998 161.164 86.8463 162.768C86.0012 163.945 85.2931 165.254 84.3485 166.356C83.1372 167.769 81.2269 169.89 80.6916 171.71C80.2672 173.153 78.5435 174.483 77.7936 175.795C77.3842 176.511 76.3252 176.938 75.696 177.451C74.5191 178.41 73.1723 179.224 72.0804 180.266C70.3387 181.929 67.7077 184.133 65.4012 184.875C64.5038 185.164 63.7783 185.796 62.8896 186.035C61.4083 186.432 59.8923 186.671 58.4184 187.083C53.2233 188.538 47.9578 188.713 42.5622 188.45C41.3956 188.393 40.1848 187.866 39.0432 187.594C38.5389 187.474 37.2324 187.242 36.918 186.849C36.3784 186.174 36.2858 185.166 35.4276 184.737"
            stroke={color}
            fill="none"
            strokeWidth="23"
            strokeLinecap="round"
          />
          <path
            id="stroke_r"
            clipPath="url(#clip_r)"
            d="M36.918 184.738C35.7135 184.46 34.5819 183.676 33.537 183.04C33.0009 182.714 32.4112 182.073 31.7569 182.005C30.0526 181.829 30.1293 179.133 29.4937 177.782C28.3647 175.383 29.3858 172.593 28.5967 170.068C28.1655 168.688 28.2143 167.198 28.0309 165.776C27.9561 165.197 28.0476 164.596 27.9481 164.024C27.8638 163.539 27.4789 163.283 27.4789 162.768C27.4789 162.143 27.462 161.516 27.4789 160.891C27.5105 159.721 28.1889 158.902 28.4449 157.814C29.0028 155.442 30.329 153.429 31.3429 151.217C31.9318 149.932 32.9199 148.972 33.744 147.864C34.8866 146.327 35.8681 144.721 37.1388 143.269C39.733 140.304 43.2494 137.891 45.612 134.685C46.7816 133.098 47.8858 131.458 49.0896 129.896C49.5725 129.27 50.2713 127.671 50.9802 127.343C52.6084 126.592 53.687 125.117 55.2444 124.238C57.4743 122.981 59.5832 121.781 61.6614 120.278C63.1773 119.182 64.7987 118.278 66.2292 117.062C67.6986 115.813 69.0023 114.629 70.728 113.75C72.0264 113.089 73.3796 112.665 74.7162 111.943C75.644 111.441 77.0266 110.985 77.7936 110.218C78.1688 109.842 78.2638 109.046 78.594 108.589C79.1698 107.792 79.4397 106.961 79.9188 106.105C82.1726 102.081 85.4166 99.0397 88.9439 96.0865C90.6419 94.665 92.0974 92.8072 93.9947 91.6429C95.9433 90.4472 98.0206 89.4963 99.9149 88.2205C102.074 86.7661 104.309 85.4382 106.47 83.9977C109.164 82.2017 112.07 80.2179 114.998 78.8366C120.971 76.0192 127.596 74.8354 133.642 72.185C136.505 70.93 140.354 69.1416 142.474 66.6236C143.235 65.7199 143.969 65.6392 144.986 64.9814C146.242 64.1683 147.066 62.8978 148.256 62.0282C148.793 61.6359 149.063 60.9908 149.429 60.4412C150.013 59.566 150.944 58.8026 151.679 58.0538C152.443 57.2745 153.104 56.427 153.9 55.6802C154.337 55.2706 154.498 54.663 154.853 54.1898C155.178 53.7563 155.715 53.5786 156.039 53.141C157.406 51.2961 159.028 50.1297 160.759 48.6698C161.391 48.137 161.804 47.1242 162.719 47.1242C163.897 47.1242 165.102 46.2022 166.031 45.5786C168.653 43.8175 170.811 42.137 172.765 39.5618C173.519 38.5685 174.135 37.4718 175.194 36.7742C178.816 34.3871 182.179 31.2673 186.261 29.6259C187.807 29.0043 189.168 27.9603 190.705 27.3627C191.798 26.9378 193.118 26.8963 194.155 26.4519C196.583 25.4113 199.147 25.5135 201.745 25.5135C203.071 25.5135 204.576 25.7239 205.885 25.4859C207.206 25.2456 207.997 24.7683 209.362 24.7683C213.659 24.7683 218.123 24.3174 222.114 26.2587C226.591 28.4367 229.428 32.632 229.428 37.6022C229.428 42.723 230.349 48.6478 227.992 53.3618C226.925 55.4964 225.608 57.5267 224.57 59.696C222.51 64.0034 219.727 67.0371 216.055 69.9356C214.643 71.0508 213.092 71.9796 211.681 73.1234C210.078 74.4226 208.312 76.3353 206.451 77.1944C205.367 77.6947 204.36 79.5055 203.511 80.3545C202.628 81.2379 202.155 82.2303 201.193 83.0593C198.904 85.0326 196.441 86.651 193.769 88.0549C192.784 88.5721 191.993 89.3564 191.022 89.8627C187.626 91.6345 184.575 93.9583 181.473 96.1555C180.343 96.9561 179 97.5528 177.761 98.1565C176.394 98.8222 175.17 99.9491 173.786 100.503C170.137 101.962 166.233 102.924 162.346 103.387C159.811 103.689 157.609 104.868 155.129 105.194C152.75 105.507 150.766 106.036 148.601 107.071C147.56 107.569 146.287 107.216 145.248 107.844C144.446 108.328 143.726 108.581 142.847 108.741C140.963 109.084 138.685 109.224 136.775 109.224C135.633 109.224 131.803 108.526 132.828 110.356C135.056 114.335 137.718 117.961 139.521 122.168C140.558 124.589 141.22 127.471 141.508 130.062C141.764 132.369 142.809 134.824 143.371 137.072C143.657 138.216 144.427 139.158 144.71 140.288C145.25 142.451 146.35 144.307 147.207 146.346C147.684 147.479 148.297 148.522 148.822 149.63C149.397 150.844 149.705 152.307 150.45 153.425C151.184 154.527 151.615 155.806 152.424 156.862C153.497 158.263 154.667 159.658 155.625 161.14C156.187 162.007 156.449 163.026 156.95 163.927C157.498 164.914 158.319 165.69 158.882 166.66C159.826 168.285 160.678 169.963 161.628 171.6C162.384 172.902 163.417 174.081 164.099 175.409C167.231 181.509 173.828 185.697 179.748 188.657C184.825 191.195 189.692 194.092 195.425 194.867C197.149 195.1 199.155 195.044 200.876 194.894C203.033 194.707 204.276 193.669 206.161 192.852C210.092 191.148 214.023 189.237 217.339 186.449C218.205 185.721 219 184.895 219.837 184.13C220.442 183.577 220.922 182.909 221.506 182.336C221.975 181.877 222.637 181.707 223.107 181.26C224.742 179.707 226.274 178.316 227.689 176.485C229.195 174.535 230.302 171.775 231.222 169.53C232.246 167.03 232.52 164.299 233.706 161.885C234.619 160.025 235.389 158.968 235.389 156.834C235.389 155.511 235.628 153.711 236.134 152.446"
            stroke={color}
            fill="none"
            strokeWidth="23"
            strokeLinecap="round"
          />
        </g>
      </svg>
    </div>
  );
}
